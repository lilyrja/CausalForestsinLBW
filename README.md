# Causal Forests in LBW
## The heterogeneous effect of low birth weight on infant mortality and long-term outcomes vary across socioeconomic and demographic groups

### Data
Our study uses two key data sources on twin births in the United States (U.S.) between 1983 and 2000. This controls for all observed and unobserved characteristics of the mother. In the case of identical twins, it guarantees that the birth weight differences are entirely driven by environmental factors rather than any genetic factors. The first is the National Center for Health Statistics (NCHS) linked birth-infant death data, providing detailed birth and infant mortality records for infants who die within their first year of life. The second is the Healthcare Cost and Utilisation Project (HCUP) state inpatient database, which contains hospital discharge data from participating states.

The NCHS dataset links birth certificate information with infant death records, offering insights into maternal and infant characteristics. It includes details such as maternal age, education, race, marital status, prenatal care and tobacco use during pregnancy. Infant data includes birth weight, gestational age, APGAR scores and whether the birth was part of a multiple-birth event. From 1989, twin records were positioned next to each other in the dataset, making it easier to pair twins for analysis. For earlier years, a covariate-matching approach was used to identify twin pairs. Subsequent sensitivity analyses confirmed that different matching methods produced nearly identical results, ensuring the reliability of the findings (Almond et al., 2005).

The HCUP dataset consists of hospital discharge records from participating U.S. states, covering approximately 80% of all hospital discharges. It contains demographic and clinical details such as diagnosis, length of hospital stays medical costs and patient outcomes. For this study, a key variable is birth weight ‚Äì however only five states: Arizona, Colorado, Maryland, New York and New Jersey, recorded birth weight data. The analysis primarily uses data from New York and New Jersey, covering about a quarter of total hospital discharge records in 2000.

### Study Design
Prior to analysis, the dataset underwent rigorous cleaning and preprocessing to ensure reliability and consistency. This involved handling missing values, standardising variable formats, and verifying data integrity. Additionally, necessary transformations were applied to prepare the dataset for causal inference, including the encoding of categorical and continuous variables where applicable. For instance, the continuous LBW treatment was converted to a binary assignment based on if the infant was under 2500g (LBW) or otherwise.
We conducted the experiment using three variations of the dataset to examine heterogeneity in the results. In the first approach, we aggregated the mortality outcome and LBW treatment indicator at the twin-pair level. This was done after verifying through a contingency table (Table 1 & 2) that majority of deceased infants had LBW. For each twin pair, the combined mortality indicator was assigned a value of 1 if at least one twin had died and 0 otherwise. Similarly, the combined treatment indicator was assigned a value of 1 if at least one twin was classified as LBW and 0 otherwise. In the second and third approaches, we conducted the analysis separately for each twin, using data for the lighter twin (twin_0) and the heavier twin (twin_1), respectively.

For each variation, a causal forest model was implemented to estimate the CATE using the grf and causalweight package in R. The estimation incorporated honesty splitting to ensure robust and unbiased estimated treatment effects. To assess which covariates contributed most significantly to treatment heterogeneity, we modelled the CATE estimates as a function of the covariates using random forests (RF) via the randomForest package in R. This allowed us to identify the top five most predictive variables, offering insights into the key factors influencing treatment effects. Following the identification of the most influential covariates, we further investigated how treatment effects varied across different subgroups based on these predictors using the best linear projection of the CATE. By stratifying the population according to these variables, we aimed to uncover meaningful patterns in treatment heterogeneity that could inform targeted policy interventions.

To formulate optimal treatment allocation strategies policy trees were employed via the policytree, Matching and DiagrammeR package in R to determine how treatments should be assigned to maximise overall benefit, particularly for the most vulnerable subpopulations identified earlier. This was achieved through a decision tree approach, where treatment assignment was guided by the CATE: G(1,ùëã) - G(0, ùëã) = Œï[ùëå(1) ‚àí ùëå(0)| ùëã], ensuring that individuals most likely to benefit were prioritised. The depth of the policy tree was optimised to maintain interpretability while maximising treatment effectiveness by performing cross-validation from depths 1 to 5, enabling targeted treatment recommendations, such as policies addressing maternal smoking if it emerged as a key risk factor. While policy learning does not directly involve learning treatment effects, it relies on good causal identification to generate the doubly robust scores necessary to fit a model (Rehill & Biddle, 2024). This helps to learn policies from large datasets with high external validity.
To validate the robustness of the causal forest estimates, we compared them with T- and X-learners to cross-check the similarity of the predictive covariates found. The T-learner trains two separate models: one for the treated group and another for the control group. The CATE is then estimated by taking the difference between the predicted outcome from these two models. This method is straightforward and flexible since it allows for any supervised learning algorithm such as random forest or neural networks to be used for outcome modelling. However, it may perform poorly when treatment assignment is highly imbalanced, as one model may suffer from a lack of data. The X-learner addresses this limitation by incorporating an additional step that estimates individual treatment effects more efficiently, especially when treatment assignment is unbalanced (K√ºnzel et al., 2019). It first trains two separate models, similar to the T-learner, but computes the imputed treatment effect (ITE) for each group (treated and control). Then, it trains another model to predict the CATE based on the ITEs of each group with a weighting function to adjust for differences in sample sizes.

The ‚ÄúCausal Inference for the Brave and True‚Äù by Matheus Facure was utilised, an open source coding material on causal inference based in python. Using cumulative gain curves, we evaluated the area under the curve (AUC) to assess the predictive performance of different models. We also examined the covariates identified as most predictive by the metalearners, comparing them with those selected by the causal forests. By taking the union of the most predictive subpopulations across models, we aimed to construct the most comprehensive set of vulnerable groups for policy intervention. We then re-ran the policy tree analyses with the new set of unified covariates to evaluate if different models suggested divergent treatment allocation strategies. Finally, we synthesised our findings with existing research to propose suitable policy recommendations for the identified at-risk populations.
